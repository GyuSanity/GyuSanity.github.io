---
layout: post
title: 3. Todo App 리펙토링
category: [Toy Project(Todo Web)]
tag: [Vue.js]
---

## Navigation Var

- **[](#)**
- **[](#)**

---

## Todo App 애플리케이션 구조 개선

- `값 업데이트` :컴포넌트가 분리가 되면서 인풋으로 값추가 되거나, clear All로 local storage 값을 clear할 경우 list가 업데이트 되지 않음
  - 업데이트 안되는 이유?
    - `created 라이프 싸이클 훅` : 리스트 컴포넌트에서 list에 이쓴 값들은 컴포넌트가 생성되는 created 라이플 싸이클 훅이 발생해야만 값이 업데이트가 됨

---

## 구조 개선

- 데이터 삭제 및 추가가 되었을떄 업데이트가 안되는 문제임으로, 하위 컴포넌트들은 상위 컴포넌트의 값을 바라보도록만 작업하고, 하위 컴포넌트에서 데이터 바인딩 및 이벤트를 상위 컴포넌트에서 주고 받도록 처리할 예정

* `컴포넌트 설계` : 단순하게 화면에 표현하는 `presentor component`, 데이터 조작(비지니스 로직)이 이뤄지는 곳을 `container component`라고 표현을 함

##### Current Architecture

<img src="/public/img/VueProject/1.cur_figure.png">

##### Refactorign Architecture

<img src="/public/img/VueProject/2.refactor_figure.png"> 
___

## 리펙토링 시작

1. List Vue -> App vue로 `데이터(todoItems)` 및 `created` 라이프 싸이클 훅 옮기기
2. `v-bind:[자식컴포넌트 프롭스 속성 이름]=내릴 데이터` : list vue 컴포넌트에 사용중인 데이터를 프롭스로 내릴수 있도록 변경

```javascript
//1번 수행
export default {

  data:function(){
    return{
      todoItems: []
    }
  },
  //리펙토링 하면서 list 라이프 싸이클 훅 created 부분 들고오기
  created: function(){
    if(localStorage.length > 0){
      for(let i=0; i<localStorage.length; i++){
        //completed가 들어오면서 아래 key value가 일치하지 않고 다름
        //this.todoItems.push(localStorage.key(i))

        //넣을때는 스트링파이로 어플리케이션측에서 값을 보도록 찍으나,
        //값을 뺼때는 다시 obj 형태로 값을 뺴와야 obj로 값 접근이 용이
        // JSON.parse = obj 형태로 되돌려서 사용
        // console.log(typeof( localStorage.getItem(localStorage.key(i))))
        // console.log(JSON.parse( localStorage.getItem(localStorage.key(i))))
        if(localStorage.key(i) !== 'loglevel:webpack-dev-server')
        this.todoItems.push(JSON.parse(localStorage.getItem(localStorage.key(i))))
      }
    }
  },

//2번 수행

<!-- 리펙토링 ( list의 todoitems를 app으로 올리고 props로 내려주기) -->
    <!-- <TodoList></TodoList> -->
    <TodoList v-bind:props-data="todoItems" v-on:removeTodo="removeTodo"></TodoList>

//+ 위 변경 후 list vue에선 props 정의 및 해당 데이터로 v-for 출력
//> html
<li v-for="(todoItem, index) in propsData"
        v-bind:key="todoItem.item"
        class="shadow">

//> template에 props 정의
export default {
    props: ['propsData'],
}

```

3. Input vue -> app vue로 `emit` 이벤트 넣고 addEvent 발생 시키기

```javascript

//app에서 addTodoItem Emit 등록 및 해당 이벤트 함수 정의
<!-- 리펙토링 하위 컴포넌트에서 발생한 이벤트 캐치 -->
<!-- <TodoInput></TodoInput> -->
<TodoInput v-on:addTodoItem="addOneItem"></TodoInput>

methods: {
    //리펙토링하면서 TodoInput에 AddItem 함수값을 받아오기
    addOneItem: function(todoItem){
        if (this.newTodoItem !== ''){
        let obj = {completed: false, item: todoItem}
        localStorage.setItem(todoItem, JSON.stringify(obj))
        this.todoItems.push(obj)
        }
    },
}

//Input vue에선 emit으로 addTodoItem 발생

<template>
  export default {
    methods:{
      addTodo: function(){
        if (this.newTodoItem !== ''){
          //addTodoItem 이벤트가 발생하고 input에 들어온 값을 올림
          this.$emit('addTodoItem', this.newTodoItem)
          this.clearInput();
        }
      },
    }
  }
</template>

```

---

##

- ***

##

-
